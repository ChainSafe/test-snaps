<!doctype html>
<html>
  </head>
    <title></title>
  </head>
  <body>
    <h1>Test Snaps</h1>
    <section>
      <h1>Confirm Snap</h1>
      <br/>
      <button class="connectHello">Connect To Confirm Snap</button>
      <input class="confirmPromptInput" placeholder="hello"/>
      <input class="confirmDescription"/>
      <input class="confirmTextAreaContent"/>
      <button class="sendHello">Send Inputs to Hello Snap</button>
      <span class="sendResults"></span>
    </section>
    <section>
      <h1>Error Snap</h1>
      <button class="connectError">Connect Error Snap</button>
      <button class="sendError">Send Test to Error Snap</button>
    </section>
  </body>

  <script>
    const snapId = `local:http://localhost:8082`;
    const snapId2 = `local:http://localhost:8081`;

    const connectButton = document.querySelector('button.connectHello')
    const sendButton = document.querySelector('button.sendHello')
    const sendResults = document.querySelector('.sendResults');
    const connectErrorButton = document.querySelector('button.connectError')
    const sendErrorButton = document.querySelector('button.sendError')

    connectButton.addEventListener('click', connect)
    sendButton.addEventListener('click', send)

    connectErrorButton.addEventListener('click', connectError)
    sendErrorButton.addEventListener('click', sendError)

    async function connectError () {
      await ethereum.request({
        method: 'wallet_enable',
        params: [{
          wallet_snap: { [snapId2]: {} },
        }]
      })
    }

    // here we get permissions to interact with and install the snap
    async function connect () {
      await ethereum.request({
        method: 'wallet_enable',
        params: [{
          wallet_snap: { [snapId]: {} },
        }]
      })
    }

    // here we call the error snap with any method
    async function sendError () {
      try {
        const response = await ethereum.request({
          method: 'wallet_invokeSnap',
          params: [snapId2, {
            method: 'test'
          }]
        })
      } catch (err) {
        console.error(err)
        alert('Problem happened: ' + err.message || err)
      }
    }

    // here we call the snap's "confirm" method
    async function send () {
      const promptInput = document.querySelector('.confirmPromptInput').value;
      const description = document.querySelector('.confirmDescription').value;
      const textAreaContent = document.querySelector('.confirmTextAreaContent').value;
      try {
        const response = await ethereum.request({
          method: 'wallet_invokeSnap',
          params: [snapId, {
            method: 'confirm',
            params: [promptInput, description, textAreaContent]
          }]
        })
        sendResults.innerHTML = response;
      } catch (err) {
        console.error(err)
        alert('Problem happened: ' + err.message || err)
      }
    }
  </script>
</html>